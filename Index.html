<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Miner Wars - GoMining</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
<style>
  /* Reset & base */
  * { box-sizing: border-box; }
  html, body {
    margin: 0; padding: 0; height: 100%;
    font-family: 'Poppins', sans-serif;
    background: url('fond.png') no-repeat center center fixed;
    background-size: cover;
    color: #e0e7ff;
    overflow-x: hidden;
    position: relative;
  }
  body::before {
    content: "";
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: radial-gradient(circle at top left, #0ff 15%, transparent 85%),
                radial-gradient(circle at bottom right, #0ff 10%, transparent 90%);
    opacity: 0.05;
    z-index: 0;
  }
  .container {
    position: relative;
    z-index: 2;
    max-width: 900px;
    margin: 40px auto;
    padding: 20px 30px 60px;
    background: rgba(10, 17, 31, 0.8);
    border-radius: 15px;
    box-shadow: 0 0 20px rgba(0,255,255,0.15);
  }
  h1 {
    margin-bottom: 5px;
    color: #00e5ff;
    font-weight: 600;
    font-size: 2.5rem;
    text-align: center;
    text-shadow: 0 0 10px #00e5ffaa;
  }
  p {
    text-align: center;
    font-weight: 400;
    font-size: 1.1rem;
    margin-top: 0;
    color: #a2b3ffcc;
    margin-bottom: 30px;
  }
  .approximate-note {
    font-size: 0.9rem;
    color: #a2b3ff88;
    text-align: center;
    margin-top: -20px;
    margin-bottom: 30px;
  }
  .tables-wrapper {
    display: flex;
    gap: 40px;
    justify-content: center;
    flex-wrap: wrap;
  }
  table {
    background: #152033;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgb(0 230 255 / 0.15);
    border-collapse: separate;
    border-spacing: 0;
    width: 350px;
    color: #d9e8ff;
    font-size: 1rem;
    transition: box-shadow 0.3s ease;
  }
  table:hover { box-shadow: 0 6px 20px rgb(0 230 255 / 0.4); }
  tbody tr { border-bottom: 1px solid #244166; transition: background-color 0.25s ease; }
  tbody tr:last-child { border-bottom: none; }
  tbody tr:hover { background-color: #0c254d33; }
  td { padding: 15px 18px; vertical-align: middle; }
  td:first-child { font-weight: 600; }
  strong { color: #00dfff; font-weight: 700; }
  input[type=number],
  input[type=range],
  select {
    background: #0b192f;
    border: 1.8px solid #008db9;
    border-radius: 8px;
    color: #00e5ff;
    font-weight: 600;
    font-size: 1rem;
    padding: 8px 12px;
    min-width: 70px;
    transition: all 0.3s ease;
    -webkit-appearance: none;
    appearance: none;
  }
  input[type=range] { min-width: 120px; cursor: pointer; }
  input[type=number] { width: 80px; text-align: center; }
  select { width: 100px; }
  input[type=number]:focus,
  input[type=range]:focus,
  select:focus {
    outline: none;
    border-color: #00e5ff;
    box-shadow: 0 0 6px #00e5ffaa;
    background: #0f2a47;
    color: #aef7ff;
  }
  input[type=number]::-webkit-inner-spin-button,
  input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
  input[type=number] { -moz-appearance: textfield; }
  #reductionNumber { margin-left: 10px; }
  .conversion-reset-wrapper {
    max-width: 700px;
    margin: 50px auto 0;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
    flex-wrap: wrap;
  }
  #conversionTable {
    background: #152033;
    border-radius: 12px;
    box-shadow: 0 6px 18px rgb(0 230 255 / 0.2);
    padding: 20px;
    color: #d9e8ff;
    flex-grow: 1;
    min-width: 0;
  }
  #conversionTable table { width: 100%; box-shadow: none; }
  #conversionTable td:first-child { font-weight: 600; font-size: 1.05rem; color: #00bcd4; }
  #btcPriceLive {
    font-weight: 600;
    color: #00e5ffcc;
    text-shadow: 0 0 8px #00e5ff88;
    text-align: center;
    margin-bottom: 18px;
  }
  #resetValues {
    background:#008db9;
    color:#fff;
    border:none;
    padding: 10px 18px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 600;
    height: 50px;
    flex-shrink: 0;
    margin-left: 20px;
    transition: background-color 0.3s ease;
    white-space: nowrap;
  }
  #resetValues:hover { background: #005f73; }
  #toggleDonate {
    display: block;
    margin: 40px auto 0;
    background: #00e5ff;
    color: #0a121f;
    border: none;
    font-weight: 700;
    font-size: 1rem;
    padding: 10px 20px;
    border-radius: 8px;
    cursor: pointer;
    transition: background 0.3s ease;
  }
  #toggleDonate:hover { background: #00b3cc; }
  #donationSection {
    max-width: 500px;
    margin: 0 auto;
    overflow: hidden;
    max-height: 0;
    opacity: 0;
    transition: max-height 0.6s ease, opacity 0.6s ease;
  }
  #donationSection.active {
    max-height: 300px;
    opacity: 1;
  }
  .donation-item {
    margin-bottom: 15px;
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 12px;
    flex-wrap: wrap;
  }
  .donation-item label { min-width: 130px; text-align: right; }
  .donation-item input {
    background: #152033;
    border: none;
    color: #00e5ff;
    font-weight: 700;
    font-size: 1rem;
    padding: 10px 12px;
    border-radius: 8px;
    user-select: all;
    max-width: 280px;
  }
  .copy-btn {
    cursor: pointer;
    background: #00e5ff;
    border: none;
    color: #0a121f;
    font-weight: 700;
    font-size: 1rem;
    padding: 10px 15px;
    border-radius: 8px;
    transition: background-color 0.3s ease;
  }
  .copy-btn:hover { background-color: #00b3cc; }
  #infoImageContainer img {
    transition: transform 0.3s ease;
    transform-origin: top left;
    transform: scale(1);
    cursor: default;
  }
  #infoImageContainer:hover img { transform: scale(1.7); }
  #comparisonWrapper {
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 140px;
    margin-right: 20px;
  }
  #comparisonWrapper h2 {
    color:#00e5ff;
    font-weight: 600;
    font-size: 1.1rem;
    margin: 0 0 8px 0;
    text-align: center;
  }
  #comparisonTable {
    width: 140px;
    background:#152033;
    border-radius:12px;
    box-shadow: 0 4px 12px rgb(0 230 255 / 0.15);
    color:#d9e8ff;
    font-size:1rem;
    text-align: center;
  }
  #comparisonTable td { padding: 15px 18px; }
  @media (max-width: 780px) {
    .tables-wrapper { flex-direction: column; align-items: center; gap: 30px; }
    table, #conversionTable { width: 90vw; max-width: 400px; }
    .donation-item label { min-width: auto; flex-basis: 100%; text-align: center; margin-bottom: 6px; }
    .conversion-reset-wrapper {
      flex-direction: column;
      align-items: stretch;
      gap: 20px;
    }
    #resetValues {
      margin-left: 0;
      height: 44px;
      width: 100%;
    }
    #comparisonWrapper {
      width: 100%;
      max-width: 400px;
      margin-right: 0;
      margin-bottom: 20px;
    }
    #comparisonTable { width: 100%; }
  }
</style>
</head>
<body>

<div class="container">
  <h1>Miner Wars - GoMining</h1>
  <p>Calculateur de gains personnels hebdomadaires</p>
  <p class="approximate-note">* Données approximatives, à titre indicatif uniquement.</p>

  <div class="tables-wrapper">
    <table>
      <tbody>
        <tr><td>TH personnels :</td><td><input id="thPersonnels" type="number" min="0" step="0.01" value="10" /></td></tr>
        <tr><td>TH du clan :</td><td><input id="thClan" type="number" min="1" step="0.01" value="100" /></td></tr>
        <tr style="position: relative;">
          <td style="position: relative;">
            <span>Gains globaux du clan (BTC) :</span>
            <span id="infoBtn"
              style="background:#008db9; color:#fff; font-weight:bold; border-radius:50%; width:20px; height:20px; cursor:pointer; margin-left:8px; font-size:14px; line-height:20px; display:inline-block; text-align:center; user-select:none;">
              ?
            </span>
            <div id="infoImageContainer"
              style="display:none; position:absolute; top:28px; left:0; z-index:10; background:#152033; padding:8px; border-radius:8px; box-shadow: 0 0 12px #00e5ffaa; max-width:300px;">
              <img src="monimage.png"
                   alt="Explication Gains Globaux du Clan"
                   style="max-width:100%; height:auto; display:block;" />
            </div>
          </td>
          <td><input id="gainsClan" type="number" min="0" step="0.0001" value="0.5" /></td>
        </tr>
        <tr style="border-top: 1px solid #244166;">
          <td><strong>Gains bruts :</strong></td>
          <td><strong id="gainsBruts">0</strong> BTC</td>
        </tr>
      </tbody>
    </table>

    <table>
      <tbody>
        <tr>
          <td>Rabais sur l'entretien (%) :</td>
          <td>
            <input id="reduction" type="range" min="0" max="30" step="0.1" value="10" />
            <input id="reductionNumber" type="number" min="0" max="30" step="0.1" value="10" />
          </td>
        </tr>
        <tr style="border-top: 1px solid #244166;">
          <td><strong>Gains nets après frais d’entretien (50%) :</strong></td>
          <td><strong id="gainsNets">0</strong> BTC</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="conversion-reset-wrapper">
    <div id="comparisonWrapper">
      <h2>Solo brut</h2>
      <table id="comparisonTable">
        <tbody>
          <tr>
            <td id="comparisonMultiplier">-</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div id="conversionTable">
      <div id="btcPriceLive">
        <span>Cours Bitcoin :</span>
        <span><strong><span id="btcPriceEUR">-</span> €</strong></span>
        <span>|</span>
        <span><strong><span id="btcPriceUSD">-</span> $</strong></span>
      </div>
      <table>
        <tbody>
          <tr><td>Devise :</td><td><select id="currencySelect"><option value="eur">EUR (€)</option><option value="usd">USD ($)</option></select></td></tr>
          <tr style="border-top: 1px solid #244166;"><td><strong>Valeur :</strong></td><td><strong id="convertedValue">-</strong></td></tr>
        </tbody>
      </table>
    </div>

    <button id="resetValues">Reset</button>
  </div>

  <button id="toggleDonate">Donate</button>
  <div id="donationSection">
    <div class="donation-item">
      <label for="btcAddress">Adresse Bitcoin :</label>
      <input id="btcAddress" type="text" readonly value="bc1q70mx6hx27vy2hr22tan7wfue8972j6qa8glvq7" />
      <button class="copy-btn" data-copy-target="btcAddress">Copier</button>
    </div>
    <div class="donation-item">
      <label for="goMiningAddress">Adresse GoMining :</label>
      <input id="goMiningAddress" type="text" readonly value="0xa56c6866270AC9d3De2CA11Bb517826410CB68E3" />
      <button class="copy-btn" data-copy-target="goMiningAddress">Copier</button>
    </div>
  </div>
</div>

<script>
  const thPersonnelsInput = document.getElementById('thPersonnels');
  const thClanInput = document.getElementById('thClan');
  const gainsClanInput = document.getElementById('gainsClan');
  const reductionInput = document.getElementById('reduction');
  const reductionNumberInput = document.getElementById('reductionNumber');
  const gainsBrutsDisplay = document.getElementById('gainsBruts');
  const gainsNetsDisplay = document.getElementById('gainsNets');
  const btcPriceEURDisplay = document.getElementById('btcPriceEUR');
  const btcPriceUSDDisplay = document.getElementById('btcPriceUSD');
  const currencySelect = document.getElementById('currencySelect');
  const convertedValueDisplay = document.getElementById('convertedValue');
  const comparisonMultiplierCell = document.getElementById('comparisonMultiplier');

  let btcPriceEUR = 0, btcPriceUSD = 0;

  function calculate() {
    const thPersonnels = parseFloat(thPersonnelsInput.value) || 0;
    const thClan = parseFloat(thClanInput.value) || 1;
    const gainsClan = parseFloat(gainsClanInput.value) || 0;
    const reduction = parseFloat(reductionInput.value) || 0;

    const gainsBruts = (thPersonnels / thClan) * gainsClan;

    const fraisEntretien = 0.5;
    const gainsNets = gainsBruts * (1 - fraisEntretien * (1 - reduction / 100));

    gainsBrutsDisplay.textContent = gainsBruts.toFixed(8);
    gainsNetsDisplay.textContent = gainsNets.toFixed(8);

    updateConvertedValue(gainsNets);
    updateComparisonTable(gainsNets, thPersonnels);
  }

  function updateConvertedValue(btcValue) {
    if (btcPriceEUR === 0 || btcPriceUSD === 0) {
      convertedValueDisplay.textContent = '-';
      return;
    }
    if (currencySelect.value === 'eur') {
      convertedValueDisplay.textContent = (btcValue * btcPriceEUR).toFixed(2) + ' €';
    } else {
      convertedValueDisplay.textContent = (btcValue * btcPriceUSD).toFixed(2) + ' $';
    }
  }

  function updateComparisonTable(btcValue, thPersonnels) {
    if (btcPriceUSD === 0) {
      comparisonMultiplierCell.textContent = '-';
      comparisonMultiplierCell.style.color = '#d9e8ff';
      return;
    }
    const valueUSD = btcValue * btcPriceUSD;
    const soloHebdoUSD = 0.25 * thPersonnels;

    if (soloHebdoUSD === 0) {
      comparisonMultiplierCell.textContent = '-';
      comparisonMultiplierCell.style.color = '#d9e8ff';
      return;
    }

    const ratio = valueUSD / soloHebdoUSD;
    const color = ratio > 1 ? '#00ff88' : (ratio < 1 ? '#ff5555' : '#d9e8ff');
    comparisonMultiplierCell.textContent = ratio.toFixed(2) + 'x';
    comparisonMultiplierCell.style.color = color;
  }

  async function fetchBTCPrice() {
    try {
      const res = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=eur,usd');
      const data = await res.json();
      btcPriceEUR = data.bitcoin.eur;
      btcPriceUSD = data.bitcoin.usd;
      btcPriceEURDisplay.textContent = btcPriceEUR.toLocaleString('fr-FR');
      btcPriceUSDDisplay.textContent = btcPriceUSD.toLocaleString('en-US');
      calculate();
    } catch (err) {
      btcPriceEURDisplay.textContent = '-';
      btcPriceUSDDisplay.textContent = '-';
    }
  }

  [thPersonnelsInput, thClanInput, gainsClanInput].forEach(el => el.addEventListener('input', calculate));
  reductionInput.addEventListener('input', () => {
    reductionNumberInput.value = reductionInput.value;
    calculate();
  });
  reductionNumberInput.addEventListener('input', () => {
    reductionInput.value = reductionNumberInput.value;
    calculate();
  });
  currencySelect.addEventListener('change', () => calculate());

  document.getElementById('resetValues').addEventListener('click', () => {
    thPersonnelsInput.value = 10;
    thClanInput.value = 100;
    gainsClanInput.value = 0.5;
    reductionInput.value = 10;
    reductionNumberInput.value = 10;
    calculate();
  });

  document.getElementById('toggleDonate').addEventListener('click', () => {
    const section = document.getElementById('donationSection');
    section.classList.toggle('active');
  });

  document.querySelectorAll('.copy-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const target = document.getElementById(btn.getAttribute('data-copy-target'));
      target.select();
      document.execCommand('copy');
      btn.textContent = 'Copié !';
      setTimeout(() => btn.textContent = 'Copier', 2000);
    });
  });

  document.getElementById('infoBtn').addEventListener('mouseover', () => {
    document.getElementById('infoImageContainer').style.display = 'block';
  });
  document.getElementById('infoBtn').addEventListener('mouseout', () => {
    document.getElementById('infoImageContainer').style.display = 'none';
  });

  fetchBTCPrice();
  setInterval(fetchBTCPrice, 60000);
  calculate();
</script>

</body>
</html>
